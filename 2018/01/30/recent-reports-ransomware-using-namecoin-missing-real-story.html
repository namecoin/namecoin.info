<!DOCTYPE html>
<html class="nojs">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Recent Reports of Ransomware Using Namecoin are Missing the Real Story</title>
    <!--<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">-->

    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <link href="/css/style.css" rel="stylesheet">
    
    <link rel="canonical" href="https://namecoin.bit/2018/01/30/recent-reports-ransomware-using-namecoin-missing-real-story.html">
    <link rel="alternate" type="application/rss+xml" title="Namecoin News" href="/feed.rss"/>

    <link rel="icon" href='/images/namecoin-coin_100px.png' sizes="100x100" type="image/png">
    <link rel="icon" href='/images/namecoin-coin_200px.png' sizes="200x200" type="image/png">
    <link rel="icon" href='/images/namecoin-coin.svg' sizes="any" type="image/svg+xml">

    <script src="/js/jquery-2.2.4.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/remove-nojs.js"></script>
</head>


  <body>

    <header class="site-header">

        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href='/'><img src='/images/logo.png' alt="Namecoin" /></a>
                </div>
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse" tabindex="">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="navbar-collapse collapse" id="navbar-collapse">
                <ul class="nav navbar-nav navbar-left">
                    <li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" tabindex="">Get Started</a>
                        <ul class="dropdown-menu">
                            <li><a href='/download/'>Download</a></li>
                            <li><a href='/get-started/name-wallets/'>Name Wallets</a></li>
                            <li><a href='/get-started/get-namecoins/'>Get Namecoins</a></li>
                            <li><a href='/docs/name-owners/'>Docs for Domain Owners</a></li>
                        </ul>
                    </li>
                    <li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" tabindex="">Dot-Bit</a>
                        <ul class="dropdown-menu">
                            <li><a href='/dot-bit/'>Home</a></li>
                            <li><a href='/dot-bit/browsing-instructions/'>Browsing Instructions</a></li>
                            <li><a href='/dot-bit/security-model/'>Security Model</a></li>
                        </ul>
                    </li>
                    <li><a href='/docs/faq/'>FAQ</a></li>
                    <li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" tabindex="">Resources</a>
                        <ul class="dropdown-menu">
                            <li><a href='/resources/chat/'>Matrix/IRC Chat</a></li>
                            <li><a href="https://nf.bit">Forum&#10138;</a></li>
                            <li><a href='/resources/presentations/'>Presentations</a></li>
                            <li><a href='/explorers/'>Explorers</a></li>
                            <li><a href='https://metrics.namecoin.bit/'>Metrics</a></li>
                            <li><a href='/resources/whitepaper/'>Whitepaper</a></li>
                            <li><a href="https://github.com/namecoin/meta/blob/master/roadmap.md">Roadmap&#10138;</a></li>
                        </ul>
                    </li>
                    <li><a href='/team/'>Team</a></li>
                    <li><a href='/news/'>News</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href='/contribute/'>Contribute</a></li>
                </ul>
                </div>
            </div>
        </nav>

</header>

<div id="fancy-graphic"><div class="container-fluid"><p id="tagline">
<span id="default-tagline">

A <strong>trust anchor</strong><br />for the Internet.
</span>

    <span class="candidate-tagline" hidden>
        <strong>In information</strong><br />we <strong>trust</strong>.
    </span>

    <span class="candidate-tagline" hidden>
        A <strong>trust anchor</strong><br />for the Internet.
    </span>

    <span class="candidate-tagline" hidden>
        <strong>Against<br />censorship.</strong>
    </span>

    <span class="candidate-tagline" hidden>
        <strong>Supporting<br />free speech.</strong>
    </span>

    <span class="candidate-tagline" hidden>
        Decentralized<br /><strong>secure</strong> names.
    </span>

    <span class="candidate-tagline" hidden>
        <strong>Decentralize</strong><br>all the things!
    </span>

    <span class="candidate-tagline" hidden>
        <strong>Freedom</strong><br>of information.
    </span>

</p></div></div>


    <div id="content">
      <div class="container-fluid">
        



















































































































































































































































































































































































































































































































































<div class="post">

<header class="post-header">
<h1 class="post-title">Recent Reports of Ransomware Using Namecoin are Missing the Real Story</h1>
<p class="post-meta">Jan 30, 2018 • Jeremy Rand <i class="fa fa-tag"></i></p>
</header>

<article class="post-content">
<p>Some reports are making the rounds that a new ransomware strain, “GandCrab”, is using Namecoin for C&amp;C.  While this may sound interesting, as far as I can tell these reports are missing the real story.</p>

<p>Looking at the <a href="https://www.bleepingcomputer.com/news/security/gandcrab-ransomware-distributed-by-exploit-kits-appends-gdcb-extension/">report on Bleeping Computer</a>, we see these quotes:</p>

<blockquote>
  <p>Another interesting feature is GandCrab’s use of the NameCoin .BIT top-level domain.  .BIT is not a TLD that is recognized by the Internet Corporation for Assigned Names and Numbers (ICANN), but is instead managed by <a href="https://namecoin.org/">NameCoin’s</a> decentralized domain name system.</p>
</blockquote>

<blockquote>
  <p>The developers of GandCrab are using NameCoin’s DNS as it makes it harder for law enforcement to track down the owner of the domain and to take the domains down.</p>
</blockquote>

<p>This doesn’t make much sense, since Namecoin isn’t anonymous (so tracking down the owner of the domain is relatively straightforward for law enforcement).  But more to the point, most Internet users don’t have Namecoin installed, and it would be rather odd for ransomware to bundle a Namecoin name lookup client.  This confusion is explained by Bleeping Computer (to their credit):</p>

<blockquote>
  <p>This means that any software that wishes to resolve a domain name that uses the .BIT tld, must use a DNS server that supports it. GandCrab does this by making dns queries using the a.dnspod.com DNS server, which is accessible on the Internet and can also  be used to resolve .bit domains.</p>
</blockquote>

<p>Yep, if this is to be believed, GandCrab isn’t actually using Namecoin, they’re using a centralized DNS server (<code class="highlighter-rouge">a.dnspod.com</code>) which nominally claims to mirror the namespace of Namecoin.  This means that, if law enforcement wants to censor the C&amp;C <code class="highlighter-rouge">.bit</code> domains, they don’t need to censor Namecoin (which would be rather difficult), they simply need to look up who owns <code class="highlighter-rouge">dnspod.com</code> (under ICANN policy, looking this up is straightforward for law enforcement) and send them a court order to censor the C&amp;C domains.</p>

<p>However, Bleeping Computer is actually substantially wrong on this point.  Why?  Take a look in the Namecha.in block explorer at <a href="https://namecha.in/name/d/bleepingcomputer">the Namecoin value of <code class="highlighter-rouge">bleepingcomputer.bit</code></a>, which is one of the alleged C&amp;C domains:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"ns":["A.DNSPOD.COM","B.DNSPOD.COM"]}
</code></pre></div></div>

<p>First off, note that this is actually a completely invalid Namecoin configuration, because <a href="https://help.directadmin.com/item.php?id=541">the trailing period is missing</a> from the authoritative nameserver addresses, so any DNS software that tries to process that Namecoin domain will return <code class="highlighter-rouge">SERVFAIL</code>.  Second, note that the authoritative nameservers listed are… the <code class="highlighter-rouge">dnspod.com</code> nameservers.  This makes it pretty clear that <code class="highlighter-rouge">a.dnspod.com</code> isn’t actually a Namecoin DNS inproxy.  If it were, and even if the trailing-period fail were corrected in the Namecoin value, the inproxy would end up in a recursion loop.  <code class="highlighter-rouge">a.dnspod.com</code> is actually just a random authoritative nameserver that happens to be serving records for a domain name that ends in <code class="highlighter-rouge">.bit</code>.  <strong>Namecoin isn’t used anywhere by GandCrab, and killing the Namecoin domain wouldn’t have any effect on GandCrab.</strong>  Of course, this raises questions about why exactly that domain name is even registered in Namecoin.  The simplest explanations are:</p>

<ol>
  <li>The GandCrab developers are massively incompetent, and have potentially deanonymized themselves by registering a Namecoin domain despite not ever using that Namecoin domain for their ransomware.</li>
  <li>Someone unrelated to GandCrab has registered that Namecoin domain for the purpose of trolling security researchers.</li>
</ol>

<p>It’s conceivable that <code class="highlighter-rouge">dnspod.com</code>’s nameservers will only allow a <code class="highlighter-rouge">.bit</code> domain’s records to be served from their systems if that <code class="highlighter-rouge">.bit</code> domain’s Namecoin data points to <code class="highlighter-rouge">dnspod.com</code>’s namservers, and it’s further possible that their systems are misconfigured to not notice that the trailing period is missing.  However, this seemed rather unlikely to me.  Why?  Well, first, take a look at the WHOIS data for <code class="highlighter-rouge">dnspod.com</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Registrar URL: http://www.dnspod.cn
Registrar: DNSPod, Inc.
Registrar IANA ID: 1697
</code></pre></div></div>

<p>So DNSPod is apparently an ICANN-accredited DNS registrar, with a primary domain name in China.  Which of these scenarios fits better with Occam’s Razor:</p>

<ol>
  <li>A DNS registrar located in China (which is not exactly known for its government’s respect for Namecoin’s values of free speech), which is accredited by ICANN (which doesn’t recognize Namecoin as either a DNS TLD or a special-use TLD), is doing special processing of domain names that they host in order to respect the authority of Namecoin.  They’ve also never contacted the Namecoin developers to inform us that they’re doing this, nor are any of their technical people active in the Namecoin community.</li>
  <li>DNSPod simply doesn’t care what domains their customers host on their nameservers, since if DNSPod’s nameservers aren’t authorized by a domain’s NS record in the DNS, nothing bad will happen anyway (DNSPod simply won’t receive any requests for that domain).</li>
</ol>

<p>In addition, if DNSPod had such a policy, it’s not clear how exactly their customers would be able to switch their Namecoin domains to DNSPod nameservers without encountering downtime while DNSPod was waiting for the Namecoin transaction to propagate.</p>

<p>However, since empiricism is informative, Ryan Castellucci tested this with an account on DNSPod, and confirmed that no such validation occurs:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dig +tcp jeremyrandissomesortofhumanperson.bit @a.dnspod.com

; &lt;&lt;&gt;&gt; DiG 9.9.5-9+deb8u14-Debian &lt;&lt;&gt;&gt; +tcp jeremyrandissomesortofhumanperson.bit @a.dnspod.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 23586
;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 3, ADDITIONAL: 1
;; WARNING: recursion requested but not available

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;jeremyrandissomesortofhumanperson.bit. IN A

;; ANSWER SECTION:
jeremyrandissomesortofhumanperson.bit. 600 IN A 255.255.255.255

;; AUTHORITY SECTION:
jeremyrandissomesortofhumanperson.bit. 600 IN NS b.dnspod.com.
jeremyrandissomesortofhumanperson.bit. 600 IN NS c.dnspod.com.
jeremyrandissomesortofhumanperson.bit. 600 IN NS a.dnspod.com.

;; Query time: 595 msec
;; SERVER: 101.226.79.205#53(101.226.79.205)
;; WHEN: Wed Jan 31 03:04:24 UTC 2018
;; MSG SIZE  rcvd: 160
</code></pre></div></div>

<p>(Ryan doesn’t own <code class="highlighter-rouge">jeremyrandissomesortofhumanperson.bit</code>.)  Ryan also did the same for <code class="highlighter-rouge">bleepingcomputer.iq</code>, implying that DNSPod isn’t verifying ownership of DNS domain names either:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dig +tcp bleepingcomputer.iq @a.dnspod.com A

; &lt;&lt;&gt;&gt; DiG 9.9.5-9+deb8u14-Debian &lt;&lt;&gt;&gt; +tcp bleepingcomputer.iq @a.dnspod.com A
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 50149
;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 3, ADDITIONAL: 1
;; WARNING: recursion requested but not available

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;bleepingcomputer.iq.           IN      A

;; ANSWER SECTION:
bleepingcomputer.iq.    600     IN      A       8.8.8.8

;; AUTHORITY SECTION:
bleepingcomputer.iq.    600     IN      NS      a.dnspod.com.
bleepingcomputer.iq.    600     IN      NS      b.dnspod.com.
bleepingcomputer.iq.    600     IN      NS      c.dnspod.com.

;; Query time: 5758 msec
;; SERVER: 101.226.79.205#53(101.226.79.205)
;; WHEN: Wed Jan 31 03:00:39 UTC 2018
;; MSG SIZE  rcvd: 142
</code></pre></div></div>

<p>Ryan tried registering a <code class="highlighter-rouge">.onion</code> domain and <code class="highlighter-rouge">bleepingcomputer.malware</code> on DNSPod as well, but these were rejected as invalid TLD’s.  Ryan and I have no clue why <code class="highlighter-rouge">.bit</code> is on DNSPod’s TLD whitelist while <code class="highlighter-rouge">.onion</code> isn’t – probably because a customer asked for it and DNSPod just doesn’t care.</p>

<p>Ryan isn’t aware of any prior cases where a malware C&amp;C was set up in a random free authoritative DNS provider such as DNSPod, with the DNS servers hardcoded in the malware.  It’s an interesting strategy for malware authors, since authoritative DNS providers usually don’t bother to confirm domain name ownership.  Entertainingly, Ryan found that DNSPod isn’t verifying ownership of the email addresses used to register accounts either.</p>

<p>So in conclusion: while this is a rather interesting case of a possible hilarious opsec fail by a ransomware author (which very well might get them arrested), and the strategy of using authoritative DNS hosting providers for malware C&amp;C is fascinating as well, the ransomware itself is fully irrelevant to Namecoin.</p>

</article>

</div>













































































































































































































































      </div>
    </div>

    <footer class="site-footer">

        <div class="container-fluid" id="social">
            <ul class="list-inline">
                <li><a href="https://github.com/namecoin"><i class="fa fa-github fa-2x" title="GitHub">GitHub</i></a></li>
                <li><a href="https://twitter.com/Namecoin"><i class="fa fa-twitter fa-2x" title="Twitter">Twitter</i></a></li>
                <li><a href="https://www.reddit.com/r/namecoin"><i class="fa fa-reddit-alien fa-2x" title="Reddit">Reddit</i></a></li>
                <li><a href="https://nf.bit/"><i class="fa fa-comments fa-2x" title="Forum">Forum</i></a></li>
                <li><a href="/license.html/"><i class="fa fa-2x" title="Copyright">Copyright</i></a></li>
            </ul>
        </div>

        <div class="container-fluid" id="page-source">
            <a href="https://github.com/namecoin/namecoin.org/blob/master/_posts/2018-01-30-recent-reports-ransomware-using-namecoin-missing-real-story.md"><i>Submit corrections or improvements to this page</i></a>
        </div>

        <div class="container-fluid" id="page-alternate">
            <ul class="list-inline">
                <li>This page is available via:</li>
                <li><a href="https://www.namecoin.org/2018/01/30/recent-reports-ransomware-using-namecoin-missing-real-story.html">DNS (namecoin.org)</a></li>
                <li><a href="https://www.rw6nbpjrmcpdxszn3air4bt7t75rpz4cp3c2kbdu72ptua57tzvin4id.onion/2018/01/30/recent-reports-ransomware-using-namecoin-missing-real-story.html">Onion</a></li>
                <li><a href="http://127.0.0.1:43110/1EZSUprqJQph9JwKg3gAJtiNs899vatZTo/2018/01/30/recent-reports-ransomware-using-namecoin-missing-real-story.html">ZeroNet</a></li>
                <li><a href="https://namecoin.bit/2018/01/30/recent-reports-ransomware-using-namecoin-missing-real-story.html">Namecoin (namecoin.bit)</a></li>
            </ul>
        </div>

        <div class="container-fluid" id="funders">
            <p>Thanks to our funders:</p>
            
            <ul class="list-inline">
                
                    <li class="funder"><a href='https://www.f2pool.com/'>F2Pool</a></li>
                
                    <li class="funder">Cyphrs</li>
                
                    <li class="funder"><a href='https://autonomousworlds.com/'>Autonomous Worlds Ltd (Xaya)</a></li>
                
                    <li class="funder">European Commission Directorate-General for Communications Networks, Content and Technology (via Next Generation Internet Zero: Search and Discovery)</li>
                
                    <li class="funder"><a href='https://nlnet.nl/internethardening/'>NLnet Foundation (Internet Hardening Fund)</a></li>
                
                    <li class="funder">Netherlands Ministry of Economic Affairs (via Internet Hardening Fund)</li>
                
                    <li class="funder"><a href='https://cyberia.club/'>Cyberia Computer Club</a></li>
                
                    <li class="funder"><a href='https://www.cyphermarket.com/'>Cypher Market</a></li>
                
                    <li class="funder"><a href='https://nlnet.nl/discovery/'>NLnet Foundation (Next Generation Internet Zero: Search and Discovery)</a></li>
                
                    <li class="funder">Handshake</li>
                
            </ul>
        </div>
</footer>


  </body>

</html>
